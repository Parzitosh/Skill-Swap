<%- include('partials/header', { title: 'My Profile' }) %>

<nav>
    <ul>
        <li><strong>SkillSwap</strong></li>
    </ul>
    <ul>
        <li><a href="/users/dashboard" class="secondary">Dashboard</a></li>
        <li><a href="/users/profile" class="secondary">My Profile</a></li>
        <li><a href="/users/requests" class="secondary">My Requests</a></li>
        <li><a href="/users/logout" role="button">Logout</a></li>
        <li><a href="/users/wishlist" class="secondary">My Wishlist</a></li>
    </ul>
</nav>

<h1>Welcome, <%= user.name %>!</h1>

<!-- Profile Details Section -->
<article>
    <header>
        <strong>My Details</strong>
        <small>My Rating: ‚≠ê <%= user.averageRating %> (<%= user.reviewCount %> reviews)</small>
    </header>
    <p><strong>Email:</strong> <%= user.email %></p>
    <p><strong>Location:</strong> <%= user.location || 'Not set' %></p>
    <p><strong>Bio:</strong> <%= user.bio || 'Not set' %></p>
    
    <details>
        <summary>Edit Profile Details</summary>
        <form action="/users/profile/update" method="POST">
            <label for="location">Location</label>
            <input type="text" id="location" name="location" value="<%= user.location %>" placeholder="e.g., San Francisco, CA">
            
            <label for="bio">Bio</label>
            <textarea id="bio" name="bio" placeholder="Tell us a little about yourself..."><%= user.bio %></textarea>
            
            <button type="submit">Save Changes</button>
        </form>
    </details>
</article>
<hr>

<!-- Skills Management Section -->
<div class="grid">
    <article>
        <h2>Skills I Can Offer:</h2>
        <% if (user.skillsOffered && user.skillsOffered.length > 0) { %>
            <ul>
                <% user.skillsOffered.forEach(skill => { %>
                    <li><%= skill %></li>
                <% }) %>
            </ul>
        <% } else { %>
            <p>You haven't added any skills to offer yet.</p>
        <% } %>
        <form action="/users/profile/add-skill-offered" method="POST">
            <input type="text" name="skill" placeholder="e.g., Python" required>
            <button type="submit">Add Skill to Offer</button>
        </form>
    </article>
    <article>
        <h2>Skills I Need:</h2>
        <% if (user.skillsNeeded && user.skillsNeeded.length > 0) { %>
            <ul>
                <% user.skillsNeeded.forEach(skill => { %>
                    <li><%= skill %></li>
                <% }) %>
            </ul>
        <% } else { %>
            <p>You haven't added any skills you need yet.</p>
        <% } %>
        <form action="/users/profile/add-skill-needed" method="POST">
            <input type="text" name="skill" placeholder="e.g., React" required>
            <button type="submit">Add Skill You Need</button>
        </form>
    </article>
</div>

<%- include('partials/footer') %>